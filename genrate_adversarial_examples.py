import numpy as np
from tensorflow.keras.models import load_model
from art.estimators.classification import KerasClassifier
from art.attacks.evasion import FastGradientMethod
from load_data import load_data
model = load_model("model/malware_detection_model.h5")
X_test, y_test = load_data("data/test/")
classifier = KerasClassifier(model=model, clip_values=(0, 1))
attack = FastGradientMethod(estimator=classifier, eps=0.1)
X_test_adv = attack.generate(X_test)
clean_eval = model.evaluate(X_test, y_test)
print("Clean Test Accuracy:", clean_eval[1])
adv_eval = model.evaluate(X_test_adv, y_test)
print("Adversarial Test Accuracy:", adv_eval[1])
