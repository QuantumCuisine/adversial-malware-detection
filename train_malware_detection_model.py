import numpy as np
from tensorflow.keras.optimizers import Adam
from load_data import load_data
from malware_detection_model import build_model
X_train, y_train = load_data("data/train/")
X_test, y_test = load_data("data/test/")
X_train = X_train / 255.0
X_test = X_test / 255.0
model = build_model(input_shape=X_train[0].shape)
model.compile(optimizer=Adam(), loss='binary_crossentropy', metrics=['accuracy'])
model.fit(X_train, y_train, epochs=10, batch_size=32, validation_data=(X_test, y_test))
model.save("model/malware_detection_model.h5")
